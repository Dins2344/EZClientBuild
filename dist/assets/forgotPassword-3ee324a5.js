import{r as l,j as e,L as x,u as v}from"./index-49fb6d1c.js";import{u as g}from"./formik.esm-96ebf386.js";import{c as f,a as m,b as y}from"./index.esm-c5c4b215.js";import{O as P,f as N,a as O}from"./signUp-84196a95.js";import{Q as p,k as b}from"./ReactToastify-489188e9.js";import{a as C}from"./loginForm-eebaebf0.js";import"./envConfig-9a8092f4.js";import"./useDispatch-a047db9f.js";const k=()=>{const[t,i]=l.useState(""),[s,d]=l.useState(!1),[r,a]=l.useState(""),[u,c]=l.useState(),o=g({initialValues:{email:""},validationSchema:f({email:m().email("Invalid email address").required("Email is required")}),onSubmit:async h=>{const j="OTPLogin";try{console.log(h),a(h.email);const n=await P(h.email,j);n!=null&&n.data.status?(c(!0),w()):i("Entered email is not registered")}catch(n){alert(n),console.log(n.toString())}}}),w=()=>{p.success("OTP has been successfully sent to this email address.",{position:"bottom-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})};return e.jsxs(e.Fragment,{children:[e.jsx(b,{position:"bottom-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored"}),e.jsx("div",{className:"lg:max-w-lg mx-auto flex justify-center",children:e.jsx("div",{className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 w-9/12 lg:w-9/12 md:w-6/12 ",children:s?e.jsx(T,{email:r}):e.jsx(e.Fragment,{children:u?e.jsx(S,{setEmailVerified:d,email:r}):e.jsxs("form",{onSubmit:o.handleSubmit,children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Confirm email"}),e.jsxs("div",{className:"mb-6",children:[t&&e.jsx("div",{className:"text-red-500",children:t}),e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"email",children:"Email"}),e.jsx("input",{name:"email",value:o.values.email,onChange:o.handleChange,onBlur:o.handleBlur,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"email",type:"email",placeholder:"Enter your email"}),o.touched.email&&o.errors.email&&e.jsx("div",{className:"text-red-500",children:o.errors.email})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800",to:"/register/user-login",children:"Back to login"}),e.jsx("button",{className:"bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",children:"Send OTP"})]})]})})})})]})},S=({email:t,setEmailVerified:i})=>{const[s,d]=l.useState(""),[r,a]=l.useState(""),u=async()=>{const o=await O(s,t,"signUpOTP");o!=null&&o.data.OTPValidation?i(!0):a(o==null?void 0:o.data.message)};return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Enter your OTP"}),e.jsxs("div",{className:"mb-6",children:[r&&e.jsx("div",{className:"text-red-500",children:r}),e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"email",children:"Enter OTP"}),e.jsx("input",{name:"OTP",value:s,onChange:c=>d(c.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"email",placeholder:"Enter your OTP"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800",to:"/register/user-login",children:"Back to login"}),e.jsx("button",{className:"bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",onClick:u,children:"verify"})]})]})})},T=({email:t})=>{const i=v(),s=g({initialValues:{email:t,password:"",confirmPassword:""},validationSchema:f({email:m().email("Invalid email address").required("Email is required"),password:m().required("Password is required"),confirmPassword:m().oneOf([y("password")],"Passwords must match").required("Confirm password is required")}),onSubmit:async r=>{try{const a=await N(r.email,r.password);a!=null&&a.data.ok&&d()}catch(a){alert(a),console.log(a.toString())}}}),d=()=>{p.success("Successfully changed password. Please login with your new password",{position:"bottom-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),setTimeout(()=>i("/register/user-login"),3e3)};return e.jsxs(e.Fragment,{children:[e.jsx(b,{position:"bottom-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored"}),e.jsxs("form",{onSubmit:s.handleSubmit,children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Enter new password"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"password",children:"Password"}),e.jsx("input",{name:"password",value:s.values.password,onChange:s.handleChange,onBlur:s.handleBlur,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"password",type:"password",placeholder:"Enter your password"}),s.touched.password&&s.errors.password&&e.jsx("div",{className:"text-red-500",children:s.errors.password})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"confirmPassword",children:"Confirm password"}),e.jsx("input",{name:"confirmPassword",value:s.values.confirmPassword,onChange:s.handleChange,onBlur:s.handleBlur,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"confirmPassword",type:"password",placeholder:"Re-enter password"}),s.touched.password&&s.errors.confirmPassword&&e.jsx("div",{className:"text-red-500",children:s.errors.confirmPassword})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800",to:"/register/user-login",children:"Back to login"}),e.jsx("button",{className:"bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",children:"Change"})]})]})]})},R=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full h-screen justify-center overflow-hidden items-center",children:[e.jsx("div",{className:"lg:w-1/2 w-full",children:e.jsx(k,{})}),e.jsx(C,{})]})});export{R as default};
